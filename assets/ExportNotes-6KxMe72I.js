import{r as u,j as e,c as H,u as G,a as J,n as K,f as X}from"../DBvtRWYK.js";import{u as $,J as V}from"./index-DzN8Ssqa.js";import{c as Z,a as Q,P as S,u as W,b as A,d as _,e as Y,C as ee,f as te,B as E,A as se}from"./index-zSO34jvX.js";import{P as oe}from"./index-BllXiYLw.js";const ne=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],I=Z("download",ne);var w="Checkbox",[re]=Q(w),[ce,R]=re(w);function ae(s){const{__scopeCheckbox:l,checked:n,children:r,defaultChecked:a,disabled:o,form:p,name:b,onCheckedChange:x,required:k,value:g="on",internal_do_not_use_render:m}=s,[h,t]=W({prop:n,defaultProp:a??!1,onChange:x,caller:w}),[c,f]=u.useState(null),[j,i]=u.useState(null),d=u.useRef(!1),v=c?!!p||!!c.closest("form"):!0,C={checked:h,disabled:o,setChecked:t,control:c,setControl:f,name:b,form:p,value:g,hasConsumerStoppedPropagationRef:d,required:k,defaultChecked:N(a)?!1:a,isFormControl:v,bubbleInput:j,setBubbleInput:i};return e.jsx(ce,{scope:l,...C,children:ie(m)?m(C):r})}var B="CheckboxTrigger",z=u.forwardRef(({__scopeCheckbox:s,onKeyDown:l,onClick:n,...r},a)=>{const{control:o,value:p,disabled:b,checked:x,required:k,setControl:g,setChecked:m,hasConsumerStoppedPropagationRef:h,isFormControl:t,bubbleInput:c}=R(B,s),f=A(a,g),j=u.useRef(x);return u.useEffect(()=>{const i=o?.form;if(i){const d=()=>m(j.current);return i.addEventListener("reset",d),()=>i.removeEventListener("reset",d)}},[o,m]),e.jsx(S.button,{type:"button",role:"checkbox","aria-checked":N(x)?"mixed":x,"aria-required":k,"data-state":U(x),"data-disabled":b?"":void 0,disabled:b,value:p,...r,ref:f,onKeyDown:_(l,i=>{i.key==="Enter"&&i.preventDefault()}),onClick:_(n,i=>{m(d=>N(d)?!0:!d),c&&t&&(h.current=i.isPropagationStopped(),h.current||i.stopPropagation())})})});z.displayName=B;var L=u.forwardRef((s,l)=>{const{__scopeCheckbox:n,name:r,checked:a,defaultChecked:o,required:p,disabled:b,value:x,onCheckedChange:k,form:g,...m}=s;return e.jsx(ae,{__scopeCheckbox:n,checked:a,defaultChecked:o,disabled:b,required:p,onCheckedChange:k,name:r,form:g,value:x,internal_do_not_use_render:({isFormControl:h})=>e.jsxs(e.Fragment,{children:[e.jsx(z,{...m,ref:l,__scopeCheckbox:n}),h&&e.jsx(O,{__scopeCheckbox:n})]})})});L.displayName=w;var M="CheckboxIndicator",T=u.forwardRef((s,l)=>{const{__scopeCheckbox:n,forceMount:r,...a}=s,o=R(M,n);return e.jsx(oe,{present:r||N(o.checked)||o.checked===!0,children:e.jsx(S.span,{"data-state":U(o.checked),"data-disabled":o.disabled?"":void 0,...a,ref:l,style:{pointerEvents:"none",...s.style}})})});T.displayName=M;var D="CheckboxBubbleInput",O=u.forwardRef(({__scopeCheckbox:s,...l},n)=>{const{control:r,hasConsumerStoppedPropagationRef:a,checked:o,defaultChecked:p,required:b,disabled:x,name:k,value:g,form:m,bubbleInput:h,setBubbleInput:t}=R(D,s),c=A(n,t),f=$(o),j=Y(r);u.useEffect(()=>{const d=h;if(!d)return;const v=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(v,"checked").set,q=!a.current;if(f!==o&&y){const F=new Event("click",{bubbles:q});d.indeterminate=N(o),y.call(d,N(o)?!1:o),d.dispatchEvent(F)}},[h,f,o,a]);const i=u.useRef(N(o)?!1:o);return e.jsx(S.input,{type:"checkbox","aria-hidden":!0,defaultChecked:p??i.current,required:b,disabled:x,name:k,value:g,form:m,...l,tabIndex:-1,ref:c,style:{...l.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});O.displayName=D;function ie(s){return typeof s=="function"}function N(s){return s==="indeterminate"}function U(s){return N(s)?"indeterminate":s?"checked":"unchecked"}function P({className:s,...l}){return e.jsx(L,{"data-slot":"checkbox",className:H("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...l,children:e.jsx(T,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(ee,{className:"size-3.5"})})})}const xe=()=>{const{t:s}=G(),l=J(),n=te(),[r,a]=u.useState({}),[o,p]=u.useState(!1),b=t=>{a(c=>({...c,[t]:!c[t]}))},x=()=>{const t=n.notes.every(f=>r[f.id]),c={};n.notes.forEach(f=>{c[f.id]=!t}),a(c)},k=()=>n.notes.filter(t=>r[t.id]).length,g=async()=>{try{p(!0);const t=n.notes.filter(C=>r[C.id]);if(t.length===0){p(!1);return}const c=new V;for(const C of t){const y=await K.export(C.id);y&&c.file(C.id,y)}const f=await c.generateAsync({type:"blob"}),i=`notes_export_${new Date().toISOString().replace(/[:.]/g,"-").slice(0,19)}.zip`,d=URL.createObjectURL(f),v=document.createElement("a");v.href=d,v.download=i,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(d)}finally{p(!1)}},m=()=>l("/settings");u.useEffect(()=>{n.getNotes()},[]);const h=()=>n.notes.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center h-full py-12",children:e.jsx("p",{className:"text-slate-500 text-center",children:s("exportNotes.noNotes")})}):e.jsxs("div",{className:"h-[calc(100vh-11rem)]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(P,{id:"toggle-select",checked:n.notes.every(t=>r[t.id]),onCheckedChange:x}),e.jsx("label",{className:"text-sm font-medium",htmlFor:"toggle-select",children:n.notes.every(t=>r[t.id])?s("exportNotes.deselectAll"):s("exportNotes.selectAll")})]}),e.jsx("div",{className:"space-y-2 mb-20",children:n.notes.map(t=>e.jsxs("div",{className:"bg-card p-5 rounded-md cursor-pointer transition-colors flex flex-col w-full",onClick:()=>b(t.id),children:[e.jsxs("div",{className:"flex justify-between items-center gap-3",children:[e.jsx(P,{checked:r[t.id],id:t.id}),e.jsx("span",{className:"font-medium mr-auto",children:t.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:X(t.updatedAt)})]}),t.isEncrypted?e.jsx("p",{className:"text-xs text-muted-foreground mt-1 italic",children:s("exportNotes.encrypted")}):e.jsx("p",{className:"text-xs text-muted-foreground truncate mt-1",children:t.snippet})]},t.id))})]});return e.jsxs("div",{className:"container max-w-5xl mx-auto flex flex-col h-full bg-background",children:[e.jsxs("div",{className:"sticky top-0 z-10 border-b px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{variant:"ghost",size:"icon",onClick:m,className:"mr-2",children:e.jsx(se,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-lg font-medium",children:s("exportNotes.title")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(E,{size:"sm",onClick:g,disabled:o||k()===0,className:"hidden sm:flex items-center",children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:s("exportNotes.buttons.export")})]}),e.jsx(E,{size:"icon",onClick:g,disabled:o||k()===0,className:"sm:hidden",children:e.jsx(I,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"flex-1 px-4 py-3 overflow-hidden",children:h()})]})};export{xe as default};
